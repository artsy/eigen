#!/usr/bin/env bash
set -exo pipefail

BUILD_TYPE=${1:-release} # default to release
if [ "$BUILD_TYPE" == "beta" ]; then
	echo "Building Android App in Beta mode"
	MODE="beta"
else
	echo "Building Android App in Release mode"
	MODE="release"
fi

pushd android

echo "Running Gradle task: assemble${BUILD_TYPE}"
yarn react-native build-android --mode=${BUILD_TYPE} --extra-params='--no-daemon --max-workers=8'

popd

if [ "$BUILD_TYPE" == "beta" ]; then
	echo "Uploading Android App for Beta"
  ./scripts/ci/upload-emu-app
fi
